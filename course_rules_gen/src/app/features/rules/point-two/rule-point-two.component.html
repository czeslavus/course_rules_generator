<section class="card shadow-sm">
  <div class="card-body">
    <h2 class="h5 card-title mb-3">
      {{ 'RULES.POINT_TWO.TITLE' | translate }}
    </h2>

    <div class="row g-3">
      <div class="col-6">
        @if (!selectedTypes().length) {
          <div class="alert alert-secondary mb-0" role="status">
            {{ 'RULES.POINT_TWO.SELECT_CLASS_TYPE_HINT' | translate }}
          </div>
        } @else {
          <div class="d-grid gap-3">
            @for (type of selectedTypes(); track type.id) {
              <fieldset class="border rounded p-3">
                <legend class="float-none w-auto px-2 mb-2 fs-6 fw-semibold">{{ type.label | translate }}</legend>

                @if (type.id !== 'lecture') {
                  <div class="mb-3">
                    <label class="form-label" [for]="'point2-max-' + type.id">
                      {{ 'RULES.POINT_TWO.MAX_UNEXCUSED_ABSENCES' | translate }}
                    </label>
                    <input
                      class="form-control"
                      type="number"
                      min="0"
                      [id]="'point2-max-' + type.id"
                      [value]="getParams(type.id).maxUnexcusedAbsences"
                      (input)="updateMaxAbsences(type.id, $any($event.target).value)"
                    />
                  </div>

                  <div class="form-check mb-3">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      [id]="'point2-makeup-' + type.id"
                      [checked]="getParams(type.id).allowMakeup"
                      (change)="updateAllowMakeup(type.id, $any($event.target).checked)"
                    />
                    <label class="form-check-label" [for]="'point2-makeup-' + type.id">
                      {{ 'RULES.POINT_TWO.MAKEUP_ALLOWED' | translate }}
                    </label>
                  </div>

                  @if (getParams(type.id).allowMakeup) {
                    <div>
                      <label class="form-label" [for]="'point2-makeup-text-' + type.id">{{ 'RULES.POINT_TWO.MAKEUP_RULES' | translate }}</label>
                      <textarea
                        class="form-control"
                        rows="4"
                        [id]="'point2-makeup-text-' + type.id"
                        [value]="getParams(type.id).makeupRulesText"
                        (input)="updateMakeupRulesText(type.id, $any($event.target).value)"
                      ></textarea>
                    </div>
                  }
                } @else {
                  <p class="text-body-secondary mb-0">{{ 'RULES.POINT_TWO.LECTURE_AUTO_TEXT' | translate }}</p>
                }
              </fieldset>
            }
          </div>
        }
      </div>

      <div class="col-6">
        <div class="border rounded p-3 h-100 bg-body-tertiary d-flex flex-column">
          <h3 class="h6 mb-2">{{ 'RULES.COMMON.GENERATED_TEXT' | translate }}</h3>
          <textarea class="form-control flex-grow-1" rows="8" readonly [value]="generatedText()"></textarea>
          <button
            type="button"
            class="btn btn-primary btn-sm mt-3 align-self-start"
            (click)="copyGeneratedText()"
            [disabled]="!generatedText()"
          >
            {{ 'RULES.COMMON.COPY_TO_CLIPBOARD' | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</section>
