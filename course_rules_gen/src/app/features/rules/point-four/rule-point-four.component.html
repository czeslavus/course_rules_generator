<section class="card shadow-sm">
  <div class="card-body">
    <h2 class="h5 card-title mb-3">
      {{ 'RULES.POINT_FOUR.TITLE' | translate }}
    </h2>

    <div class="row g-3">
      <div class="col-6">
        @if (!selectedTypes().length) {
          <div class="alert alert-secondary mb-0" role="status">
            {{ 'RULES.POINT_FOUR.SELECT_CLASS_TYPE_HINT' | translate }}
          </div>
        } @else {
          <div class="d-grid gap-3">
            @for (type of selectedTypes(); track type.id) {
              <fieldset class="border rounded p-3">
                <legend class="float-none w-auto px-2 mb-2 fs-6 fw-semibold">{{ type.label | translate }}</legend>

                @if (type.id === 'lecture' || type.id === 'classes') {
                  <div class="mb-3">
                    <label class="form-label" [for]="'point4-count-' + type.id">{{ 'RULES.POINT_FOUR.COLLOQUIUM_COUNT' | translate }}</label>
                    <input
                      class="form-control"
                      type="number"
                      min="0"
                      [id]="'point4-count-' + type.id"
                      [value]="getCount(type.id)"
                      (input)="updateCount(type.id, $any($event.target).value)"
                    />
                  </div>

                  @if (getCount(type.id) > 0) {
                    <div class="d-grid gap-2">
                      @for (week of getWeeks(type.id); track $index) {
                        <div>
                          <label class="form-label" [for]="'point4-week-' + type.id + '-' + $index">
                            {{ 'RULES.POINT_FOUR.COLLOQUIUM_TERM' | translate:{ index: $index + 1 } }}
                          </label>
                          <input
                            class="form-control"
                            type="number"
                            min="1"
                            max="15"
                            [id]="'point4-week-' + type.id + '-' + $index"
                            [value]="week"
                            (input)="updateWeek(type.id, $index, $any($event.target).value)"
                          />
                        </div>
                      }
                    </div>
                  }
                } @else if (type.id === 'project') {
                  <div class="mb-3">
                    <label class="form-label" [for]="'point4-count-' + type.id">{{ 'RULES.POINT_FOUR.STAGE_COUNT' | translate }}</label>
                    <input
                      class="form-control"
                      type="number"
                      min="0"
                      [id]="'point4-count-' + type.id"
                      [value]="getCount(type.id)"
                      (input)="updateCount(type.id, $any($event.target).value)"
                    />
                  </div>

                  @if (getCount(type.id) > 0) {
                    <div class="d-grid gap-2">
                      @for (week of getWeeks(type.id); track $index) {
                        <div>
                          <label class="form-label" [for]="'point4-week-' + type.id + '-' + $index">
                            {{ 'RULES.POINT_FOUR.STAGE_TERM' | translate:{ index: $index + 1 } }}
                          </label>
                          <input
                            class="form-control"
                            type="number"
                            min="1"
                            max="15"
                            [id]="'point4-week-' + type.id + '-' + $index"
                            [value]="week"
                            (input)="updateWeek(type.id, $index, $any($event.target).value)"
                          />
                        </div>
                      }
                    </div>
                  }
                } @else if (type.id === 'laboratory' || type.id === 'computer_classes') {
                  <label class="form-label" [for]="'point4-submission-' + type.id">
                    {{ 'RULES.POINT_FOUR.REPORT_SCHEDULE' | translate }}
                  </label>
                  <textarea
                    class="form-control"
                    rows="3"
                    [id]="'point4-submission-' + type.id"
                    [ngModel]="getSubmissionText(type.id)"
                    (ngModelChange)="updateSubmissionText(type.id, $event)"
                  ></textarea>
                } @else if (type.id === 'seminar') {
                  <label class="form-label" [for]="'point4-submission-' + type.id">
                    {{ 'RULES.POINT_FOUR.SEMINAR_TEXT' | translate }}
                  </label>
                  <textarea
                    class="form-control"
                    rows="3"
                    [id]="'point4-submission-' + type.id"
                    [ngModel]="getSubmissionText(type.id)"
                    (ngModelChange)="updateSubmissionText(type.id, $event)"
                  ></textarea>
                } @else {
                  <p class="text-body-secondary mb-0">
                    {{ 'RULES.POINT_FOUR.AUTO_GENERATED_SCHEDULE' | translate }}
                  </p>
                }
              </fieldset>
            }
          </div>
        }
      </div>

      <div class="col-6">
        <div class="border rounded p-3 h-100 bg-body-tertiary d-flex flex-column">
          <h3 class="h6 mb-2">{{ 'RULES.COMMON.GENERATED_TEXT' | translate }}</h3>
          <textarea class="form-control flex-grow-1" rows="8" readonly [value]="generatedText()"></textarea>
          <button
            type="button"
            class="btn btn-primary btn-sm mt-3 align-self-start"
            (click)="copyGeneratedText()"
            [disabled]="!generatedText()"
          >
            {{ 'RULES.COMMON.COPY_TO_CLIPBOARD' | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</section>
